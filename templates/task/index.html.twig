<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task List</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .completed {
            text-decoration: line-through;
            color: grey;
        }
        .task-list {
            list-style-type: none;
            padding-left: 0;
        }
    </style>
</head>
<body>
    <h1>Task List</h1>
    
    <!-- Form to add tasks -->
    <form method="POST" action="{{ path('task_list') }}">
        <input type="text" name="task" id="task" required placeholder="Enter task">
        <button type="submit">Add Task</button>
    </form>

    <h2>Tasks</h2>
    <ul class="task-list">
        {% for task in tasks %}
            <li class="task {{ task.completed ? 'completed' : '' }}" data-index="{{ loop.index0 }}">
                <span class="task-name">{{ task.task }}</span>
                <a href="{{ path('task_list', { 'delete': loop.index0 }) }}">Delete</a>
                <a href="{{ path('task_list', { 'toggle': loop.index0 }) }}">{{ task.completed ? 'Undo' : 'Complete' }}</a>
            </li>
        {% endfor %}
    </ul>

    <script>
        $(document).ready(function () {
            // Handle task deletion
            $('a[href*="delete"]').click(function (e) {
                e.preventDefault();
                const index = $(this).closest('li').data('index');
                window.location.href = `{{ path('task_list') }}?delete=${index}`;
            });

            // Handle task completion toggle
            $('a[href*="toggle"]').click(function (e) {
                e.preventDefault();
                const index = $(this).closest('li').data('index');
                window.location.href = `{{ path('task_list') }}?toggle=${index}`;
            });
        });
    </script>
</body>
</html>